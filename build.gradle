buildscript {
    repositories {
        mavenLocal()
        maven {
            url = 'http://172.31.0.18:8081/repository/alibaba'
            credentials {
                username = 'qk-dm-dev'
                password = 'qk-dm-dev123'
            }
        }
    }
}
apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'maven'

group 'com.qk'
description = 'qike data middle'
ext.snapshotBuild = version.contains("SNAPSHOT")

allprojects {
    repositories {
        mavenLocal()
        maven {
            url = 'http://172.31.0.18:8081/repository/alibaba'
            credentials {
                username = 'qk-dm-dev'
                password = 'qk-dm-dev123'
            }
        }
    }
    uploadArchives {
        repositories {
            mavenDeployer {
                repository(url: 'http://172.31.0.18:8081/repository/alibaba') {
                    authentication(userName: "qk-dm-dev", password: "qk-dm-dev123")
                }

                pom.whenConfigured { pom ->
                    pom.dependencies.forEach { dep ->
                        if (dep.getVersion() == "unspecified") {
                        }
                    }
                }
            }
        }
    }
}

subprojects {
    repositories {
        mavenLocal()
        maven {
            url = 'http://172.31.0.18:8081/repository/alibaba'
            credentials {
                username = 'qk-dm-dev'
                password = 'qk-dm-dev123'
            }
        }
    }
    plugins.withType(JavaPlugin) {
        project.sourceCompatibility = "11"
    }
    tasks.withType(JavaCompile) {
        options.encoding = "UTF-8"
    }
}

project.afterEvaluate {
    getSubprojects().forEach() { project ->
//        def uploadTask = project.tasks.getByName('uploadArchives')
        println(project.tasks.getByName('uploadArchives'))
    }
}